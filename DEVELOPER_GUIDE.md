# SYNK MVP ìºë¦­í„° ì‹œìŠ¤í…œ - ê°œë°œì ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

ì´ ë¬¸ì„œëŠ” SYNK MVPì˜ **ìºë¦­í„° ì‹œìŠ¤í…œ**ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
ê¸°ì¡´ ê´€ê³„ ë°ì´í„° ì‹œìŠ¤í…œì— ìºë¦­í„° í˜ë¥´ì†Œë‚˜ DBë¥¼ ì¶”ê°€í•˜ì—¬ í†µí•©í•©ë‹ˆë‹¤.

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SYNK MVP ì‹œìŠ¤í…œ                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  [ìºë¦­í„° DB]              [ê´€ê³„ ë°ì´í„° DB]                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”‚
â”‚  â€¢ í˜ë¥´ì†Œë‚˜               â€¢ ê°ì • ë³€ë™ì„±                          â”‚
â”‚  â€¢ ë§íˆ¬/ì„±ê²©              â€¢ Dominance                           â”‚
â”‚  â€¢ ê°ì • íŠ¸ë¦¬ê±°            â€¢ í•µì‹¬ ê¸°ì–µ                            â”‚
â”‚  â€¢ ë¹„ë°€/ë°°ê²½              â€¢ íŠ¸ë¦¬ê±° í‚¤ì›Œë“œ                        â”‚
â”‚       â”‚                          â”‚                              â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                  â†“                                              â”‚
â”‚           [í”„ë¡¬í”„íŠ¸ ë¹Œë”]                                        â”‚
â”‚                  â†“                                              â”‚
â”‚           [Gemini API]                                          â”‚
â”‚                  â†“                                              â”‚
â”‚           [ìºë¦­í„° ì‘ë‹µ]                                          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
synk-mvp/
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ character.py       # ìºë¦­í„° í˜ë¥´ì†Œë‚˜ ëª¨ë¸ (NEW)
â”‚   â”œâ”€â”€ relationship.py    # ê´€ê³„ ë°ì´í„° ëª¨ë¸ (ê¸°ì¡´)
â”‚   â””â”€â”€ memory.py          # ê¸°ì–µ ëª¨ë¸ (ê¸°ì¡´)
â”‚
â”œâ”€â”€ db/
â”‚   â”œâ”€â”€ character_db.py    # ìºë¦­í„° DB CRUD (NEW)
â”‚   â””â”€â”€ database.py        # ê´€ê³„ ë°ì´í„° DB (ê¸°ì¡´)
â”‚
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ character_api.py   # ìºë¦­í„° CRUD API (NEW)
â”‚   â”œâ”€â”€ chat_v2.py         # ì±„íŒ… API (ìºë¦­í„° ì—°ë™) (NEW)
â”‚   â”œâ”€â”€ chat.py            # ì±„íŒ… API (ê¸°ì¡´)
â”‚   â””â”€â”€ reaction.py        # ì´ëª¨ì§€ ë¦¬ì•¡ì…˜ API (ê¸°ì¡´)
â”‚
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ prompt_builder_v2.py  # í”„ë¡¬í”„íŠ¸ ë¹Œë” (ìºë¦­í„°+ê´€ê³„) (NEW)
â”‚   â”œâ”€â”€ prompt_builder.py     # í”„ë¡¬í”„íŠ¸ ë¹Œë” (ê¸°ì¡´)
â”‚   â”œâ”€â”€ data_collector.py     # ë°ì´í„° ìˆ˜ì§‘ (ê¸°ì¡´)
â”‚   â”œâ”€â”€ dominance_calc.py     # Dominance ê³„ì‚° (ê¸°ì¡´)
â”‚   â”œâ”€â”€ emotion_analyzer.py   # ê°ì • ë¶„ì„ (ê¸°ì¡´)
â”‚   â”œâ”€â”€ memory_manager.py     # ê¸°ì–µ ê´€ë¦¬ (ê¸°ì¡´)
â”‚   â””â”€â”€ trigger_detector.py   # íŠ¸ë¦¬ê±° ê°ì§€ (ê¸°ì¡´)
â”‚
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ seed_characters.py # ì´ˆê¸° ë°ì´í„° ì‹œë”© (NEW)
â”‚
â””â”€â”€ main.py                # ë©”ì¸ ì•± (ë¼ìš°í„° ì¶”ê°€ í•„ìš”)
```

---

## ğŸ—ƒï¸ ë°ì´í„° ëª¨ë¸

### 1. CharacterPersona (ìºë¦­í„° í˜ë¥´ì†Œë‚˜)

```python
class CharacterPersona:
    # ê¸°ë³¸ ì •ë³´
    id: str                    # "npc_lee_gaeun"
    name: str                  # "ì´ê°€ì€"
    location: str              # "ì•„ì¹´ë°ë¯¸_ì •ë¬¸"
    
    # ì„±ê²© ë° ë§íˆ¬
    personality: str           # ì„±ê²© ì„¤ëª…
    speech_style: str          # ë§íˆ¬ íŒ¨í„´
    speech_examples: List[str] # ë§íˆ¬ ì˜ˆì‹œ
    
    # ë°°ê²½ ìŠ¤í† ë¦¬
    background: str            # ë°°ê²½ ìŠ¤í† ë¦¬
    secrets: List[str]         # ë¹„ë°€ (ì¹œë°€ë„ ë†’ìœ¼ë©´ ê³µê°œ)
    
    # ê´€ê³„ ê¸°ë³¸ê°’
    user_relationship: str     # ì´ˆê¸° ê´€ê³„ ("rival", "friendly", etc.)
    dominance_default: float   # ì´ˆê¸° dominance (-1.0 ~ 1.0)
    
    # ê°ì • íŠ¸ë¦¬ê±° (í•µì‹¬!)
    emotion_triggers: Dict[str, str]  # {"ì˜¤ì´": "anger", "í˜•": "anger"}
    sensitive_topics: List[str]       # ë¯¼ê°í•œ ì£¼ì œ
    
    # ëŠ¥ë ¥ ë° íƒœê·¸
    tags: List[str]
    ability: str
    ability_rank: str          # S/A/B/C/D
    
    # XR ì „í™˜ìš©
    default_emotion: str       # ê¸°ë³¸ í‘œì •
    default_posture: str       # ê¸°ë³¸ ìì„¸
    voice_tone: str            # ëª©ì†Œë¦¬ í†¤
```

### 2. Location (ì¥ì†Œ)

```python
class Location:
    id: str              # "ë² íƒ€_ë™_ë¡œë¹„"
    name: str            # "ë² íƒ€ ë™ ë¡œë¹„"
    description: str     # ì¥ì†Œ ì„¤ëª…
    atmosphere: str      # ë¶„ìœ„ê¸°
    tags: List[str]
```

---

## ğŸ”Œ API ì—”ë“œí¬ì¸íŠ¸

### ìºë¦­í„° API

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | `/api/character/` | ìºë¦­í„° ìƒì„± |
| GET | `/api/character/` | ëª¨ë“  ìºë¦­í„° ì¡°íšŒ (?location=í•„í„°) |
| GET | `/api/character/{id}` | ìºë¦­í„° ìƒì„¸ ì¡°íšŒ |
| PUT | `/api/character/{id}` | ìºë¦­í„° ìˆ˜ì • |
| DELETE | `/api/character/{id}` | ìºë¦­í„° ì‚­ì œ |

### ì¥ì†Œ API

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | `/api/character/location/` | ì¥ì†Œ ìƒì„± |
| GET | `/api/character/location/` | ëª¨ë“  ì¥ì†Œ ì¡°íšŒ |
| GET | `/api/character/location/{id}` | ì¥ì†Œ + í•´ë‹¹ ìºë¦­í„°ë“¤ ì¡°íšŒ |

### ì±„íŒ… API (v2)

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | `/api/chat/` | ìºë¦­í„°ì™€ ëŒ€í™” (ìºë¦­í„° DB ì—°ë™) |
| POST | `/api/chat/location/{id}` | íŠ¹ì • ì¥ì†Œì—ì„œ ëŒ€í™” (ë©€í‹° ìºë¦­í„°) |

---

## ğŸ”„ ë°ì´í„° íë¦„

### ì±„íŒ… ìš”ì²­ ì²˜ë¦¬

```
1. POST /api/chat/
   â””â”€ { user_id, character_id, message }

2. ìºë¦­í„° ì •ë³´ ì¡°íšŒ
   â””â”€ get_character(character_id) â†’ CharacterPersona

3. ê´€ê³„ ë°ì´í„° ì¡°íšŒ
   â””â”€ get_relationship_data(user_id, character_id) â†’ RelationshipData

4. í”„ë¡¬í”„íŠ¸ ìƒì„±
   â”œâ”€ character.to_prompt()  â†’ ìºë¦­í„° í˜ë¥´ì†Œë‚˜
   â””â”€ build_relationship_context()  â†’ ê´€ê³„ ì»¨í…ìŠ¤íŠ¸

5. Gemini API í˜¸ì¶œ
   â””â”€ ìºë¦­í„° ì‘ë‹µ ìƒì„±

6. ë°ì´í„° ìˆ˜ì§‘
   â””â”€ process_turn() â†’ ê´€ê³„ ë°ì´í„° ì—…ë°ì´íŠ¸

7. ì‘ë‹µ ë°˜í™˜
   â””â”€ { character_response, relationship_summary }
```

---

## ğŸ¯ í•µì‹¬ 3ê°€ì§€ ë°ì´í„° ì—°ë™

### 1. ê°ì • ë³€ë™ì„± â†’ ìºë¦­í„° ë°˜ì‘

```python
# ê´€ê³„ ë°ì´í„°ì˜ ê°ì • íˆìŠ¤í† ë¦¬
rel_data.emotional_stats.joy_peaks  # ê¸°ì¨ íšŸìˆ˜
rel_data.emotional_stats.anger_peaks  # í™”ë‚¨ íšŸìˆ˜

# í”„ë¡¬í”„íŠ¸ì— ë°˜ì˜
"ê°ì • íˆìŠ¤í† ë¦¬: ê¸°ì¨ 5íšŒ, í™”ë‚¨ 2íšŒ, ì—´ê´‘ 3íšŒ"
â†’ ìºë¦­í„°ê°€ ìœ ì €ì˜ íŒ¨í„´ì„ ì¸ì§€í•˜ê³  ë°˜ì‘
```

### 2. Dominance â†’ ì‘ë‹µ í†¤

```python
# dominance < -0.3: ìœ ì € ìš°ìœ„
"ìœ ì €ê°€ ê´€ê³„ë¥¼ ì£¼ë„í•¨. ë” ìˆœì¢…ì ì´ê³  ë¶€ë“œëŸ½ê²Œ ë°˜ì‘í•˜ì„¸ìš”."

# dominance > 0.3: ìºë¦­í„° ìš°ìœ„
"ìºë¦­í„°ê°€ ê´€ê³„ë¥¼ ì£¼ë„í•¨. ë” ë‹¹ë‹¹í•˜ê³  ë„ë„í•˜ê²Œ ë°˜ì‘í•˜ì„¸ìš”."

# -0.3 ~ 0.3: ê· í˜•
"ê· í˜• ì¡íŒ ê´€ê³„. ìºë¦­í„° ë³¸ì—°ì˜ ì„±ê²©ëŒ€ë¡œ ë°˜ì‘í•˜ì„¸ìš”."
```

### 3. í•µì‹¬ ê¸°ì–µ + íŠ¸ë¦¬ê±° â†’ íŠ¹ë³„ ë°˜ì‘

```python
# ìºë¦­í„° ê¸°ë³¸ íŠ¸ë¦¬ê±°
character.emotion_triggers = {"í˜•": "anger", "í™©ì¸í•˜": "nervous"}

# ìœ ì € í–‰ë™ìœ¼ë¡œ ìŒ“ì¸ íŠ¸ë¦¬ê±° (ğŸ’¢ í´ë¦­)
rel_data.trigger_keywords = [{"keyword": "ì˜¤ì´", "emotion": "anger"}]

# í”„ë¡¬í”„íŠ¸ì— ë³‘í•©
"ì£¼ì˜ í‚¤ì›Œë“œ: í˜•, í™©ì¸í•˜, ì˜¤ì´"
â†’ í•´ë‹¹ í‚¤ì›Œë“œ ì–¸ê¸‰ ì‹œ ê°•í•œ ê°ì • ë°˜ì‘
```

---

## ğŸš€ ì„¤ì¹˜ ë° ì‹¤í–‰

### 1. ê¸°ì¡´ í”„ë¡œì íŠ¸ì— íŒŒì¼ ì¶”ê°€

```bash
# ìƒˆ íŒŒì¼ë“¤ ë³µì‚¬
cp models/character.py [í”„ë¡œì íŠ¸]/models/
cp db/character_db.py [í”„ë¡œì íŠ¸]/db/
cp api/character_api.py [í”„ë¡œì íŠ¸]/api/
cp api/chat_v2.py [í”„ë¡œì íŠ¸]/api/
cp core/prompt_builder_v2.py [í”„ë¡œì íŠ¸]/core/
cp scripts/seed_characters.py [í”„ë¡œì íŠ¸]/scripts/
```

### 2. main.py ìˆ˜ì •

```python
# ë¼ìš°í„° ì¶”ê°€
from api.character_api import router as character_router
from api.chat_v2 import router as chat_v2_router

app.include_router(character_router)
app.include_router(chat_v2_router)

# startupì— ìºë¦­í„° DB ì´ˆê¸°í™” ì¶”ê°€
from db.character_db import init_character_db

@app.on_event("startup")
async def startup_event():
    init_db()
    init_character_db()  # ì¶”ê°€
```

### 3. ì´ˆê¸° ë°ì´í„° ì‹œë”©

```bash
python scripts/seed_characters.py
```

### 4. ì„œë²„ ì‹¤í–‰

```bash
python main.py
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸

### 1. ìºë¦­í„° ì¡°íšŒ í…ŒìŠ¤íŠ¸

```bash
# ëª¨ë“  ìºë¦­í„°
curl http://localhost:8000/api/character/

# íŠ¹ì • ì¥ì†Œ ìºë¦­í„°
curl http://localhost:8000/api/character/?location=ë² íƒ€_ë™_ë¡œë¹„

# íŠ¹ì • ìºë¦­í„°
curl http://localhost:8000/api/character/npc_joo_changyun
```

### 2. ì±„íŒ… í…ŒìŠ¤íŠ¸

```bash
curl -X POST http://localhost:8000/api/chat/ \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "test_user",
    "character_id": "npc_joo_changyun",
    "message": "ì•¼ ì£¼ì°½ìœ¤!"
  }'
```

### 3. í•µì‹¬ ë°ì´í„° ê²€ì¦

```bash
# ëŒ€í™” í›„ ê´€ê³„ ë°ì´í„° í™•ì¸
curl http://localhost:8000/api/reaction/relationship/test_user/npc_joo_changyun
```

---

## ğŸ“Š ì‹œë”©ëœ ìºë¦­í„° ëª©ë¡

| ì¥ì†Œ | ìºë¦­í„° | ì—­í•  | dominance |
|------|--------|------|-----------|
| ë² íƒ€_ë™_ë¡œë¹„ | ì£¼ì°½ìœ¤ | ë¼ì´ë²Œ | +0.3 |
| ë² íƒ€_ë™_ë¡œë¹„ | í™©ì¸í•˜ | ì—¬ì™• | +0.5 |
| ë² íƒ€_ë™_ë¡œë¹„ | í‘œë‹¤ì€ | ì„œí¬í„° | -0.2 |
| ë² íƒ€_ë™_ë¡œë¹„ | ë¯¼ì•„ë¦„ | ì ë§Œë³´ | 0.0 |
| ë² íƒ€_ë™_ë¡œë¹„ | ê³ ì„ í•˜ | ê³µì£¼ë³‘ | +0.4 |
| ì§€í•˜_í›ˆë ¨ì¥ | ì‹ ì±„ë¦° | ìµœê°• | +0.6 |
| ì§€í•˜_í›ˆë ¨ì¥ | ê¶Œìš°ë¯¸ | êµìˆ˜ | +0.3 |
| ì•„ì¹´ë°ë¯¸_ì •ë¬¸ | ì´ê°€ì€ | ì†Œê¿‰ì¹œêµ¬ | -0.3 |
| ì˜ë¬´ì‹¤ | ì‹¬ë‚˜ì€ | ë‹´ì„ | +0.2 |

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **ìºë¦­í„° IDëŠ” ê³ ìœ í•´ì•¼ í•¨**
   - ì¤‘ë³µ ìƒì„± ì‹œ 400 ì—ëŸ¬

2. **ê´€ê³„ ë°ì´í„°ëŠ” ìë™ ìƒì„±**
   - ì²« ì±„íŒ… ì‹œ ìë™ìœ¼ë¡œ ê´€ê³„ ë°ì´í„° ìƒì„±

3. **ë¹„ë°€ ê³µê°œ ì¡°ê±´**
   - ì¹œë°€ë„ 5.0 ì´ìƒì´ë©´ ìºë¦­í„° ë¹„ë°€ì´ í”„ë¡¬í”„íŠ¸ì— í¬í•¨

4. **íŠ¸ë¦¬ê±° í‚¤ì›Œë“œ ë³‘í•©**
   - ìºë¦­í„° ê¸°ë³¸ íŠ¸ë¦¬ê±° + ìœ ì € í–‰ë™ íŠ¸ë¦¬ê±° ìë™ ë³‘í•©

---

## ğŸ”œ ë‹¤ìŒ ë‹¨ê³„

1. **í…ŒìŠ¤íŠ¸ ì‹¤í–‰** - ìºë¦­í„°ë³„ ì‘ë‹µ í’ˆì§ˆ í™•ì¸
2. **í•µì‹¬ ë°ì´í„° ê²€ì¦** - ê°ì •/dominance/ê¸°ì–µ ì €ì¥ í™•ì¸
3. **í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™** - UIì—ì„œ ì´ëª¨ì§€ ë¦¬ì•¡ì…˜ í…ŒìŠ¤íŠ¸
4. **ë©€í‹° ìºë¦­í„° í…ŒìŠ¤íŠ¸** - ì¥ì†Œ ê¸°ë°˜ ëŒ€í™” í…ŒìŠ¤íŠ¸
